
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-04-06
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Oryx &#x2013; Requirements</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/readable/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../css/bootswatch.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />


		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-docs-conf-ref project-oryx" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html">Oryx 2</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="../overview.html" title="Overview">Overview</a></li>
							<li ><a href="index.html" title="Documentation">Documentation</a></li>
							<li ><a href="../contribute.html" title="Contribute">Contribute</a></li>
							<li ><a href="../download.html" title="Download">Download</a></li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="http://oryxproject.github.io/oryx/" id="bannerLeft"><h1>Oryx</h1></a>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
		<div>
			<ul class="breadcrumb">
				<li class="projectVersion version-date">Version: 2.0.0-SNAPSHOT</li>
				<li class="divider">|</li>
				<li class="publishDate version-date">Last Published: 2015-04-06</li>
			</ul>
		</div>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar" data-spy="affix" data-offset-top="800">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#toc-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="nav-collapse collapse" id="toc-nav-collapse">
						<ul id="toc" class="nav">
						<li class="toplevel"><a href="#requirements" title="Requirements">Requirements</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#cluster_setup" title="Cluster Setup">Cluster Setup</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#verifying_kafka_optional" title="Verifying Kafka (Optional)">Verifying Kafka (Optional)</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#configuring_kafka" title="Configuring Kafka">Configuring Kafka</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1 id="requirements">Requirements</h1>
</div> 
<ul> 
 <li>Java 7 or later (JRE only is required) (<i>In the near future, Java 8 may be required</i>)</li> 
 <li>A Hadoop cluster running the following components: 
  <ul> 
   <li>Apache Hadoop 2.5.0 or later</li> 
   <li>Apache Zookeeper 3.4.5 or later</li> 
   <li>Apache Kafka 0.8.2 or later</li> 
   <li>Apache Spark 1.3.0 or later</li> 
  </ul></li> 
</ul> 
<p><a class="externalLink" href="http://www.cloudera.com/content/cloudera/en/products-and-services/cdh.html">CDH</a> 5.4.0 and later meet these requirements, although any Hadoop distribution with these components should work fine. While the rest of the instructions will refer to a CDH 5.4.0+ distribution, this is not a requirement.</p> 
<p><i>Note that the “alpha 1” release requires only Spark 1.2.0, and thus works with CDH 5.3.0+</i></p> 
<p>A single-node cluster can be sufficient, although running all of these components on one machine may require a reasonable amount of RAM.</p> 
<h1 id="cluster_setup">Cluster Setup</h1> 
<p>Install and configure the Hadoop cluster normally. The following services need to be enabled:</p> 
<ul> 
 <li>HDFS</li> 
 <li>YARN</li> 
 <li>Zookeeper</li> 
 <li>Kafka</li> 
 <li>Spark (on YARN)</li> 
</ul> 
<p>Note that for CDH, Kafka is available as a “CLABS 1.0.0” parcel from <a class="externalLink" href="http://www.cloudera.com/content/cloudera/en/developers/home/cloudera-labs/apache-kafka.html">Cloudera Labs</a>.</p> 
<p>Determine the (possibly several) Kafka brokers that are configured in the cluster, under Instances, and note their hosts and port. The port is typically 9092. Same for the Zookeeper servers; the default port here is 2181. Default ports will be used in subsequent examples.</p> 
<p>Where a Kafka broker or Zookeeper server is called for, you can and should specify a comma-separated list of <tt>host:port</tt> pairs where there are multiple hosts. Example: <tt>your-zk-1:2181,your-zk-2:2181</tt>.</p> 
<p>Also note whether your Zookeeper instance is using a chroot path. This is simply a path suffixed to the <tt>host:port</tt>, like <tt>your-zk:2181/your-chroot</tt>. For example in CDH, Kafka uses a <tt>/kafka</tt> chroot, and subsequent examples will use this chroot. You can omit this if you are not using a chroot.</p> 
<p>Note: if you have multiple Zookeeper servers, and a chroot, only add the chroot once, at the end: <tt>your-zk-1:2181,your-zk-2:2181/kafka</tt></p> 
<h1 id="verifying_kafka_optional">Verifying Kafka (Optional)</h1> 
<p>To quickly verify that Kafka and ZK are running correctly:</p> 
<div class="source"> 
 <div class="source"> 
  <pre>kafka-topics --create --zookeeper your-zk:2181/kafka \
  --replication-factor 1 --partitions 1 --topic test
kafka-console-consumer --zookeeper your-zk:2181/kafka \
  --topic test --from-beginning
</pre> 
 </div> 
</div> 
<p>In another console, take any text file (here <tt>data.csv</tt>) and send it to the topic:</p> 
<div class="source"> 
 <div class="source"> 
  <pre>cat data.csv | kafka-console-producer \
  --broker-list your-kafka-broker:9092 --topic test
</pre> 
 </div> 
</div> 
<p>You should see the contents of the text file echoed onto the other consumer’s console soon thereafter.</p> 
<p>Delete the test topic when done.</p> 
<div class="source"> 
 <div class="source"> 
  <pre>kafka-topics --delete --zookeeper your-zk:2181/kafka --topic test
</pre> 
 </div> 
</div> 
<h1 id="configuring_kafka">Configuring Kafka</h1> 
<p>Oryx will use two Kafka topics for data transport. One carries input data to the batch and Speed Layer, and the other carries model updates from there on to the Serving Layer. The default names of these topics are “OryxInput” and “OryxUpdate” respectively. They need to be created before Oryx is started.</p> 
<p>Each can default to have one partition, but more can be configured if much higher read throughput is needed. <tt>oryx.batch.streaming.receiver-parallelism</tt> and <tt>oryx.speed.streaming.receiver-parallelism</tt> should then be increased to match. The example below shows 1 partition. Replication factor can be any value, but 3 is recommended.</p> 
<div class="source"> 
 <div class="source"> 
  <pre>kafka-topics --create --zookeeper your-zk:2181/kafka \
  --replication-factor 3 --partitions 1 --topic OryxInput
...
Created topic &quot;OryxInput&quot;.
</pre> 
 </div> 
</div> 
<div class="source"> 
 <div class="source"> 
  <pre>kafka-topics --create --zookeeper your-zk:2181/kafka \
  --replication-factor 3 --partitions 1 --topic OryxUpdate
...
Created topic &quot;OryxUpdate&quot;.
</pre> 
 </div> 
</div> 
<p>You may need to configure the retention time for one or both topics. In particular, it’s typically important to limit the retention time for the update topic, since the Speed and Serving Layer read the entire topic from the start on startup to catch up. Setting it to twice the Batch Layer update interval is a good start. For example, to set it to 2 days (2 * 24 * 60 * 60 * 1000 = 172800000 ms):</p> 
<div class="source"> 
 <div class="source"> 
  <pre>kafka-topics --zookeeper your-zk:2181/kafka --alter --topic OryxUpdate \
  --config retention.ms=172800000
</pre> 
 </div> 
</div> 
<p>This is not as important for the input topic, which is not re-read from the beginning.</p> 
<p>Continue to <a href="./Running-Oryx.html">Running-Oryx</a> to start the servers, and run an example.</p>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span9 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014-2015. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>

	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
